var ASG;!function(t){var e=function(){function t(t,e,i){this.fullscreen=t,this.timeout=e,this.galleryId=i,this.help=!1,this.gui=!0,this._visible=!1,this._fullscreen=!1,this.functionsVisible=!1,this.transition="rotateLR",this.transitions=["no","fadeInOut","zoomInOut","rotateLR","rotateTB","rotateZY","slideLR","slideTB","flipX","flipY"],void 0==this.id&&(this.id="asgid"+this.galleryId.getNext())}return t.prototype.defaults=function(){var t={baseUrl:"",fields:{url:"url",title:"title",description:"description"}};void 0==this.options?this.options=t:this.options=angular.merge(t,this.options),void 0==this.files&&(this.files=[]),void 0==this.selected&&(this.selected=0),console.log(this.options)},t.prototype.init=function(){var t=this;this.defaults(),this.timeout(function(){var e=".gallery-view."+t.id+" li.dropdown-submenu";angular.element(e).off().on("click",function(t){t.stopPropagation(),angular.element(this).hasClass("open")?angular.element(this).removeClass("open"):(angular.element(e).removeClass("open"),angular.element(this).addClass("open"))}),t.setFocus()},100)},t.prototype.preload=function(t){var e=this;this.timeout(function(){e.loadImage(e.selected),e.loadImage(0),e.loadImage(e.selected+1),e.loadImage(e.selected-1),e.loadImage(e.selected+2),e.loadImage(e.files.length-1)},void 0!=t?t:750)},t.prototype.normalize=function(t){var e=this.files.length-1;return t>e?t-e-1:t<0?e-Math.abs(t)+1:t},t.prototype.loadImage=function(t){if(t=this.normalize(t),!this.files[t])return void console.warn("Invalid file index: "+t);if(!this.files[t].loaded){var e=this.options.baseUrl+this.files[t][this.options.fields.url];(new Image).src=e,this.files[t].source=e,this.files[t].loaded=!0,console.log(this.files[t])}},Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this._visible?(this.init(),this.preload(1),angular.element("body").addClass("yhidden")):angular.element("body").removeClass("yhidden")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSingle",{get:function(){return!(this.files.length>1)},enumerable:!0,configurable:!0}),t.prototype.setFocus=function(){angular.element(".gallery-view."+this.id+" .keyInput").trigger("focus").focus()},t.prototype.setTransition=function(t){this.transition=t,this.setFocus()},t.prototype.functionsHide=function(){this.functionsVisible=!1},t.prototype.functionsShow=function(){this.functionsVisible=!0},t.prototype.downloadLink=function(){if(void 0!=this.selected)return this.options.baseUrl+this.files[this.selected][this.options.fields.url]},Object.defineProperty(t.prototype,"file",{get:function(){return this.files[this.selected]},enumerable:!0,configurable:!0}),t.prototype.toBackward=function(){this.direction="backward",this.selected=this.normalize(this.selected-1),this.preload()},t.prototype.toForward=function(){this.direction="forward",this.selected=this.normalize(this.selected+1),this.preload()},t.prototype.toFirst=function(){this.direction="backward",this.selected=0,this.preload()},t.prototype.toLast=function(){this.direction="forward",this.selected=this.files.length-1,this.preload()},t.prototype.exit=function(){this.visible=!1},t.prototype.keyUp=function(t){27==t.keyCode&&this.exit(),32==t.keyCode&&this.toForward(),37==t.keyCode&&this.toBackward(),39==t.keyCode&&this.toForward(),38!=t.keyCode&&36!=t.keyCode||this.toFirst(),40!=t.keyCode&&35!=t.keyCode||this.toLast(),70!=t.keyCode&&13!=t.keyCode||this.toggleFullScreen(),71==t.keyCode&&this.toggleGUI(),72==t.keyCode&&this.toggleHelp(),84==t.keyCode&&this.nextTransition()},t.prototype.nextTransition=function(){var t=this.transitions.indexOf(this.transition)+1,e=t>=this.transitions.length?0:t;this.transition=this.transitions[e]},t.prototype.toggleFullScreen=function(){this.fullscreen.isEnabled()?this.fullscreen.cancel():this.fullscreen.all(),this.setFocus()},t.prototype.toggleHelp=function(){this.help=!this.help,this.setFocus()},t.prototype.toggleGUI=function(){this.gui=!this.gui},t}();t.GalleryViewController=e;var i=function(){function t(){this.id=1}return t.prototype.getNext=function(){return this.id++},t}();t.GalleryIdService=i;var o=angular.module("angularSuperGallery",["ngAnimate"]);o.service("galleryId",i),o.component("galleryView",{controller:["Fullscreen","$timeout","galleryId",t.GalleryViewController],templateUrl:"views/angular-super-gallery.html",bindings:{visible:"=",selected:"<",title:"@",subtitle:"@",files:"=",options:"=?"}}),o.provider("angularSuperGalleryOptions",function(){var t={};return{setOpts:function(e){angular.extend(t,e)},$get:function(){return t}}}),o.directive("imageOnload",function(){return{restrict:"A",link:function(t,e,i){e.bind("load",function(){t.$apply(i.imageOnload)})}}}),o.filter("bytes",function(){return function(t,e){if(isNaN(parseFloat(t))||!isFinite(t))return"";if(0===t)return"0";void 0===e&&(e=1);var i=["bytes","kB","MB","GB","TB","PB"],o=Math.floor(Math.log(t)/Math.log(1024));return(t/Math.pow(1024,Math.floor(o))).toFixed(e)+" "+i[o]}})}(ASG||(ASG={}));